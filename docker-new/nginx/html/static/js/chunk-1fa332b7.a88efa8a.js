(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1fa332b7"],{"0c59":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"myMap",staticClass:"map_demo"},[i("el-input",{staticStyle:{width:"100%"},attrs:{readonly:"",value:t.value,disabled:t.disabled,"prefix-icon":"el-icon-location-information",placeholder:"请选择坐标"},nativeOn:{click:function(e){!t.disabled&&t.initMap()}}}),i("el-dialog",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],attrs:{title:"位置选择",visible:!0,width:"800px","close-on-click-modal":!1,modal:!1},on:{close:function(e){t.visible=!1,t.pointShow=!1}}},[i("div",{staticClass:"boxCon"},[i("div",{staticClass:"indexMap",attrs:{id:"indexMap"}}),i("div",{staticClass:"operate"},[i("el-popover",{attrs:{placement:"right-start",width:"400",trigger:"click",title:"地址搜索"},model:{value:t.isShow,callback:function(e){t.isShow=e},expression:"isShow"}},[t.type?i("div",{staticClass:"search"},[i("i",{staticClass:"el-icon-sort",on:{click:t.changeType}}),i("el-autocomplete",{staticClass:"margin-tb-6",staticStyle:{width:"100%"},attrs:{"fetch-suggestions":t.fetchLocationData,placeholder:"请输入查询关键字"},on:{select:t.handleSelect},model:{value:t.address,callback:function(e){t.address=e},expression:"address"}},[i("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1):i("div",{staticClass:"coordinate"},[i("el-alert",{staticClass:"margin-tb-12",attrs:{"show-icon":"",title:"该系统采用GCJ-02坐标系，请输入该坐标系的数值",type:"warning",closable:!1}}),i("div",{staticClass:"search"},[i("i",{staticClass:"el-icon-sort",on:{click:t.changeType}}),i("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"经度"},model:{value:t.xValue,callback:function(e){t.xValue=e},expression:"xValue"}}),i("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"纬度"},model:{value:t.yValue,callback:function(e){t.yValue=e},expression:"yValue"}}),i("el-button",{attrs:{type:"text"},on:{click:t.analysis}},[t._v("搜索")])],1),i("div",{directives:[{name:"show",rawName:"v-show",value:t.place.length>0,expression:"place.length>0"}],staticClass:"list"},t._l(t.place,(function(e,a){return i("div",{key:a,on:{click:t.goTo}},[i("i",{staticClass:"el-icon-location-information"}),t._v(t._s(e))])})),0)],1),i("el-tooltip",{staticClass:"item",attrs:{slot:"reference",transition:"el-zoom-in-center",effect:"dark",content:"搜索",placement:"right"},slot:"reference"},[i("i",{staticClass:"btn el-icon-search"})])],1),i("el-tooltip",{staticClass:"item",attrs:{transition:"el-zoom-in-center",effect:"dark",content:"定位",placement:"right"}},[i("i",{staticClass:"btn el-icon-map-location",on:{click:t.adding}})])],1),i("div",{directives:[{name:"show",rawName:"v-show",value:t.pointShow,expression:"pointShow"}],staticClass:"edit"},[i("el-button",{on:{click:function(e){t.pointShow=!1}}},[t._v("取消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.confirm}},[t._v("确认")])],1),i("img",{directives:[{name:"show",rawName:"v-show",value:t.pointShow,expression:"pointShow"}],staticClass:"point",attrs:{src:a("7834"),alt:""}})])])],1)},n=[],o=a("5530"),l=a("c14f"),s=a("1da1"),r=(a("d81d"),a("a9e3"),a("d3b7"),a("ac1f"),a("841c"),a("0643"),a("4e3e"),a("a573"),a("159b"),a("862d"),a("b9d0")),c={name:"PointSelect",props:{value:{default:null,type:String},disabled:{default:!1,type:Boolean}},data:function(){return{areaId:null,type:!0,address:null,xValue:null,yValue:null,place:[],isShow:!1,area:[],overlayGroup:[],areaModule:[],visible:!1,pointShow:!1,container:null,marker:[],markerInfo:null}},watch:{isShow:{handler:function(t){t&&(this.address=null,this.type=!0)}}},methods:{initMap:function(){var t=this;return Object(s["a"])(Object(l["a"])().m((function e(){var a,i;return Object(l["a"])().w((function(e){while(1)switch(e.n){case 0:return t.map=new t.AMap.Map("indexMap",{mapStyle:"amap://styles/802500eb9c17892dd91047988cc1ece1",zoom:15,center:[120.15066,33.349802],layers:[new t.AMap.TileLayer.Satellite],doubleClickZoom:!1}),t.placeSearch=new t.AMap.PlaceSearch({city:"全国"}),t.geocoder=new t.AMap.Geocoder({city:"全国"}),t.visible=!0,e.n=1,Object(r["d"])();case 1:a=e.v,t.area=a.rows,t.createAreaPolygon(),t.value&&(i={lng:t.value.split(",")[0],lat:t.value.split(",")[1]},t.setPoint(i));case 2:return e.a(2)}}),e)})))()},createAreaPolygon:function(){var t=this,e=[];this.overlayGroup=[],this.areaModule=[],this.area.forEach((function(a){if(a.landPath){var i=[],n=[];a.landPath.split("|").forEach((function(e){i.push(new t.AMap.LngLat(e.split(",")[0],e.split(",")[1])),n.push([Number(e.split(",")[0]),Number(e.split(",")[1])])}));var o=new t.AMap.Polygon({path:i,fillColor:a.fillColor,fillOpacity:a.fillOpacity,strokeColor:a.strokeColor,strokeWeight:a.strokeWeight,strokeOpacity:a.strokeOpacity,extData:{landId:a.landId}});t.overlayGroup.push(o),e.push(new t.AMap.Text({text:a.landName,anchor:"center",position:t.getAreaCenter(n),style:{background:"transparent",color:"#fff",border:"none"}}))}})),this.AreaPolygonGroup=new this.AMap.OverlayGroup(this.overlayGroup),this.areaModule.push({label:"地块",show:!0,layer:this.AreaPolygonGroup}),this.AreaLabelGroup=new this.AMap.OverlayGroup(e),this.areaModule.push({label:"名称",show:!0,layer:this.AreaLabelGroup}),this.map.add(this.AreaLabelGroup),this.map.add(this.AreaPolygonGroup),this.map.on("click",this.clickOn),this.overlayGroup.forEach((function(e){e.on("click",t.clickOn)}))},changeType:function(){this.type=!this.type,this.address=null,this.xValue=null,this.yValue=null,this.place=[]},analysis:function(){var t=this;this.geocoder.getAddress(new this.AMap.LngLat(this.xValue,this.yValue),(function(e,a){"complete"===e&&"OK"===a.info&&(t.place=[],t.place.push(a.regeocode.formattedAddress))}))},goTo:function(){this.map.panTo([this.xValue,this.yValue])},fetchLocationData:function(t,e){var a=this;t?(clearTimeout(this.timer),this.timer=setTimeout((function(){a.placeSearch.search(t,(function(t,a){e("complete"===t?a.poiList.pois.map((function(t){return Object(o["a"])(Object(o["a"])({},t),{},{value:t.address})})):[])}))}),1200)):e([])},handleSelect:function(t){var e=this.map,a=(this.searchOverlays,t.location),i=(t.address,a.lng),n=a.lat;e.panTo([i,n])},getAreaCenter:function(t){var e=t.length,a=0,i=0,n=0;t.forEach((function(t){var e,o,l,s=t[0]*Math.PI/180,r=t[1]*Math.PI/180;e=Math.cos(r)*Math.cos(s),o=Math.cos(r)*Math.sin(s),l=Math.sin(r),a+=e,i+=o,n+=l})),a/=e,i/=e,n/=e;var o=Math.atan2(i,a),l=Math.sqrt(a*a+i*i),s=Math.atan2(n,l);return[parseFloat(180*o/Math.PI),parseFloat(180*s/Math.PI)]},adding:function(){var t=this;this.pointShow=!0,this.container=this.$el.querySelector(".indexMap"),this.container.addEventListener("mousemove",(function(e){var a=t.container.getBoundingClientRect(),i=e.clientX-a.left-10,n=e.clientY-a.top-22;t.$el.querySelector(".point").style.left=i+"px",t.$el.querySelector(".point").style.top=n+"px"}))},clickOn:function(t){var e=t.lnglat;this.pointShow&&(this.map.remove(this.marker),this.marker=[],this.setPoint(e))},setPoint:function(t){var e=document.createElement("div"),i=document.createElement("img");i.src=a("7834"),i.setAttribute("width","20px"),i.setAttribute("height","20px"),e.appendChild(i);var n=new this.AMap.Marker({position:[t.lng,t.lat]});n.setContent(e),this.marker.push(n),console.log(this.map),this.map.add(this.marker),this.markerInfo=t.lng+","+t.lat},confirm:function(){this.$emit("input",this.markerInfo),this.pointShow=!1,this.visible=!1}}},u=c,h=(a("ff67"),a("2877")),p=Object(h["a"])(u,i,n,!1,null,"624b495e",null);e["default"]=p.exports},"5f0d":function(t,e,a){},7834:function(t,e,a){t.exports=a.p+"static/img/point.0f4b3ced.svg"},b9d0:function(t,e,a){"use strict";a.d(e,"d",(function(){return n})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return l})),a.d(e,"e",(function(){return s})),a.d(e,"b",(function(){return r}));var i=a("b775");function n(t){return Object(i["a"])({url:"/agriculture/land/cropLandList",method:"get",params:t})}function o(t){return Object(i["a"])({url:"/agriculture/land/"+t,method:"get"})}function l(t){return Object(i["a"])({url:"/agriculture/land",method:"post",data:t})}function s(t){return Object(i["a"])({url:"/agriculture/land",method:"put",data:t})}function r(t){return Object(i["a"])({url:"/agriculture/land/"+t,method:"delete"})}},ff67:function(t,e,a){"use strict";a("5f0d")}}]);