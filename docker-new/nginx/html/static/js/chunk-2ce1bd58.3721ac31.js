(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2ce1bd58","chunk-1fa332b7"],{"0c59":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{ref:"myMap",staticClass:"map_demo"},[r("el-input",{staticStyle:{width:"100%"},attrs:{readonly:"",value:e.value,disabled:e.disabled,"prefix-icon":"el-icon-location-information",placeholder:"请选择坐标"},nativeOn:{click:function(t){!e.disabled&&e.initMap()}}}),r("el-dialog",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],attrs:{title:"位置选择",visible:!0,width:"800px","close-on-click-modal":!1,modal:!1},on:{close:function(t){e.visible=!1,e.pointShow=!1}}},[r("div",{staticClass:"boxCon"},[r("div",{staticClass:"indexMap",attrs:{id:"indexMap"}}),r("div",{staticClass:"operate"},[r("el-popover",{attrs:{placement:"right-start",width:"400",trigger:"click",title:"地址搜索"},model:{value:e.isShow,callback:function(t){e.isShow=t},expression:"isShow"}},[e.type?r("div",{staticClass:"search"},[r("i",{staticClass:"el-icon-sort",on:{click:e.changeType}}),r("el-autocomplete",{staticClass:"margin-tb-6",staticStyle:{width:"100%"},attrs:{"fetch-suggestions":e.fetchLocationData,placeholder:"请输入查询关键字"},on:{select:e.handleSelect},model:{value:e.address,callback:function(t){e.address=t},expression:"address"}},[r("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1):r("div",{staticClass:"coordinate"},[r("el-alert",{staticClass:"margin-tb-12",attrs:{"show-icon":"",title:"该系统采用GCJ-02坐标系，请输入该坐标系的数值",type:"warning",closable:!1}}),r("div",{staticClass:"search"},[r("i",{staticClass:"el-icon-sort",on:{click:e.changeType}}),r("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"经度"},model:{value:e.xValue,callback:function(t){e.xValue=t},expression:"xValue"}}),r("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"纬度"},model:{value:e.yValue,callback:function(t){e.yValue=t},expression:"yValue"}}),r("el-button",{attrs:{type:"text"},on:{click:e.analysis}},[e._v("搜索")])],1),r("div",{directives:[{name:"show",rawName:"v-show",value:e.place.length>0,expression:"place.length>0"}],staticClass:"list"},e._l(e.place,(function(t,a){return r("div",{key:a,on:{click:e.goTo}},[r("i",{staticClass:"el-icon-location-information"}),e._v(e._s(t))])})),0)],1),r("el-tooltip",{staticClass:"item",attrs:{slot:"reference",transition:"el-zoom-in-center",effect:"dark",content:"搜索",placement:"right"},slot:"reference"},[r("i",{staticClass:"btn el-icon-search"})])],1),r("el-tooltip",{staticClass:"item",attrs:{transition:"el-zoom-in-center",effect:"dark",content:"定位",placement:"right"}},[r("i",{staticClass:"btn el-icon-map-location",on:{click:e.adding}})])],1),r("div",{directives:[{name:"show",rawName:"v-show",value:e.pointShow,expression:"pointShow"}],staticClass:"edit"},[r("el-button",{on:{click:function(t){e.pointShow=!1}}},[e._v("取消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确认")])],1),r("img",{directives:[{name:"show",rawName:"v-show",value:e.pointShow,expression:"pointShow"}],staticClass:"point",attrs:{src:a("7834"),alt:""}})])])],1)},s=[],l=a("5530"),o=a("c14f"),i=a("1da1"),n=(a("d81d"),a("a9e3"),a("d3b7"),a("ac1f"),a("841c"),a("0643"),a("4e3e"),a("a573"),a("159b"),a("862d"),a("b9d0")),c={name:"PointSelect",props:{value:{default:null,type:String},disabled:{default:!1,type:Boolean}},data:function(){return{areaId:null,type:!0,address:null,xValue:null,yValue:null,place:[],isShow:!1,area:[],overlayGroup:[],areaModule:[],visible:!1,pointShow:!1,container:null,marker:[],markerInfo:null}},watch:{isShow:{handler:function(e){e&&(this.address=null,this.type=!0)}}},methods:{initMap:function(){var e=this;return Object(i["a"])(Object(o["a"])().m((function t(){var a,r;return Object(o["a"])().w((function(t){while(1)switch(t.n){case 0:return e.map=new e.AMap.Map("indexMap",{mapStyle:"amap://styles/802500eb9c17892dd91047988cc1ece1",zoom:15,center:[120.15066,33.349802],layers:[new e.AMap.TileLayer.Satellite],doubleClickZoom:!1}),e.placeSearch=new e.AMap.PlaceSearch({city:"全国"}),e.geocoder=new e.AMap.Geocoder({city:"全国"}),e.visible=!0,t.n=1,Object(n["d"])();case 1:a=t.v,e.area=a.rows,e.createAreaPolygon(),e.value&&(r={lng:e.value.split(",")[0],lat:e.value.split(",")[1]},e.setPoint(r));case 2:return t.a(2)}}),t)})))()},createAreaPolygon:function(){var e=this,t=[];this.overlayGroup=[],this.areaModule=[],this.area.forEach((function(a){if(a.landPath){var r=[],s=[];a.landPath.split("|").forEach((function(t){r.push(new e.AMap.LngLat(t.split(",")[0],t.split(",")[1])),s.push([Number(t.split(",")[0]),Number(t.split(",")[1])])}));var l=new e.AMap.Polygon({path:r,fillColor:a.fillColor,fillOpacity:a.fillOpacity,strokeColor:a.strokeColor,strokeWeight:a.strokeWeight,strokeOpacity:a.strokeOpacity,extData:{landId:a.landId}});e.overlayGroup.push(l),t.push(new e.AMap.Text({text:a.landName,anchor:"center",position:e.getAreaCenter(s),style:{background:"transparent",color:"#fff",border:"none"}}))}})),this.AreaPolygonGroup=new this.AMap.OverlayGroup(this.overlayGroup),this.areaModule.push({label:"地块",show:!0,layer:this.AreaPolygonGroup}),this.AreaLabelGroup=new this.AMap.OverlayGroup(t),this.areaModule.push({label:"名称",show:!0,layer:this.AreaLabelGroup}),this.map.add(this.AreaLabelGroup),this.map.add(this.AreaPolygonGroup),this.map.on("click",this.clickOn),this.overlayGroup.forEach((function(t){t.on("click",e.clickOn)}))},changeType:function(){this.type=!this.type,this.address=null,this.xValue=null,this.yValue=null,this.place=[]},analysis:function(){var e=this;this.geocoder.getAddress(new this.AMap.LngLat(this.xValue,this.yValue),(function(t,a){"complete"===t&&"OK"===a.info&&(e.place=[],e.place.push(a.regeocode.formattedAddress))}))},goTo:function(){this.map.panTo([this.xValue,this.yValue])},fetchLocationData:function(e,t){var a=this;e?(clearTimeout(this.timer),this.timer=setTimeout((function(){a.placeSearch.search(e,(function(e,a){t("complete"===e?a.poiList.pois.map((function(e){return Object(l["a"])(Object(l["a"])({},e),{},{value:e.address})})):[])}))}),1200)):t([])},handleSelect:function(e){var t=this.map,a=(this.searchOverlays,e.location),r=(e.address,a.lng),s=a.lat;t.panTo([r,s])},getAreaCenter:function(e){var t=e.length,a=0,r=0,s=0;e.forEach((function(e){var t,l,o,i=e[0]*Math.PI/180,n=e[1]*Math.PI/180;t=Math.cos(n)*Math.cos(i),l=Math.cos(n)*Math.sin(i),o=Math.sin(n),a+=t,r+=l,s+=o})),a/=t,r/=t,s/=t;var l=Math.atan2(r,a),o=Math.sqrt(a*a+r*r),i=Math.atan2(s,o);return[parseFloat(180*l/Math.PI),parseFloat(180*i/Math.PI)]},adding:function(){var e=this;this.pointShow=!0,this.container=this.$el.querySelector(".indexMap"),this.container.addEventListener("mousemove",(function(t){var a=e.container.getBoundingClientRect(),r=t.clientX-a.left-10,s=t.clientY-a.top-22;e.$el.querySelector(".point").style.left=r+"px",e.$el.querySelector(".point").style.top=s+"px"}))},clickOn:function(e){var t=e.lnglat;this.pointShow&&(this.map.remove(this.marker),this.marker=[],this.setPoint(t))},setPoint:function(e){var t=document.createElement("div"),r=document.createElement("img");r.src=a("7834"),r.setAttribute("width","20px"),r.setAttribute("height","20px"),t.appendChild(r);var s=new this.AMap.Marker({position:[e.lng,e.lat]});s.setContent(t),this.marker.push(s),console.log(this.map),this.map.add(this.marker),this.markerInfo=e.lng+","+e.lat},confirm:function(){this.$emit("input",this.markerInfo),this.pointShow=!1,this.visible=!1}}},u=c,d=(a("ff67"),a("2877")),p=Object(d["a"])(u,r,s,!1,null,"624b495e",null);t["default"]=p.exports},"1eb9":function(e,t,a){},2810:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-card",{staticClass:"card-container"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("基地信息")])]),a("el-form",{ref:"form",staticClass:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"基地简称",prop:"baseShortName"}},[a("el-input",{attrs:{placeholder:"请输入基地简称"},model:{value:e.form.baseShortName,callback:function(t){e.$set(e.form,"baseShortName",t)},expression:"form.baseShortName"}})],1),a("el-form-item",{attrs:{label:"基地编号",prop:"baseCode"}},[a("el-input",{attrs:{placeholder:"请输入基地编号"},model:{value:e.form.baseCode,callback:function(t){e.$set(e.form,"baseCode",t)},expression:"form.baseCode"}})],1),a("el-form-item",{attrs:{label:"基地全称",prop:"baseName"}},[a("el-input",{attrs:{placeholder:"请输入基地全称"},model:{value:e.form.baseName,callback:function(t){e.$set(e.form,"baseName",t)},expression:"form.baseName"}})],1),a("el-form-item",{attrs:{label:"基地负责人",prop:"baseLeader"}},[a("el-input",{attrs:{placeholder:"请输入基地负责人"},model:{value:e.form.baseLeader,callback:function(t){e.$set(e.form,"baseLeader",t)},expression:"form.baseLeader"}})],1),a("el-form-item",{attrs:{label:"基地负责人电话",prop:"leaderTel"}},[a("el-input",{attrs:{placeholder:"请输入基地负责人电话"},model:{value:e.form.leaderTel,callback:function(t){e.$set(e.form,"leaderTel",t)},expression:"form.leaderTel"}})],1),a("el-form-item",{attrs:{label:"基地负责人地址",prop:"baseAddress"}},[a("el-input",{attrs:{placeholder:"请输入基地负责人地址"},model:{value:e.form.baseAddress,callback:function(t){e.$set(e.form,"baseAddress",t)},expression:"form.baseAddress"}})],1),a("el-form-item",{attrs:{label:"基地面积",prop:"baseArea"}},[a("el-input",{attrs:{placeholder:"请输入基地面积"},model:{value:e.form.baseArea,callback:function(t){e.$set(e.form,"baseArea",t)},expression:"form.baseArea"}},[a("template",{slot:"append"},[e._v("亩")])],2)],1),a("el-form-item",{attrs:{label:"基地海拔",prop:"baseAltitude"}},[a("el-input",{attrs:{placeholder:"请输入基地海拔"},model:{value:e.form.baseAltitude,callback:function(t){e.$set(e.form,"baseAltitude",t)},expression:"form.baseAltitude"}},[a("template",{slot:"append"},[e._v("米")])],2)],1),24!=e.proportion?a("el-form-item",{attrs:{label:"基地坐标",prop:"coordinate"}},[a("point-select",{model:{value:e.form.baseCoordinate,callback:function(t){e.$set(e.form,"baseCoordinate",t)},expression:"form.baseCoordinate"}})],1):e._e(),a("el-form-item",{attrs:{label:"现场图片"}},[a("imageUpload",{attrs:{fileSize:30,limit:1},model:{value:e.form.baseImg,callback:function(t){e.$set(e.form,"baseImg",t)},expression:"form.baseImg"}})],1),a("el-form-item",{attrs:{label:"基地描述",prop:"baseDes"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:e.form.baseDes,callback:function(t){e.$set(e.form,"baseDes",t)},expression:"form.baseDes"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")]),a("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1)],1)},s=[],l=a("d415"),o=a("0c59"),i={name:"Baseinfo",components:{PointSelect:o["default"]},data:function(){return{form:{},rules:{baseShortName:[{required:!0,message:"基地简称不能为空",trigger:"blur"}],baseCode:[{required:!0,message:"基地编号不能为空",trigger:"blur"}],baseName:[{required:!0,message:"基地全称不能为空",trigger:"blur"}],baseLeader:[{required:!0,message:"基地负责人不能为空",trigger:"blur"}],leaderTel:[{required:!0,message:"基地负责人电话不能为空",trigger:"blur"}],baseAddress:[{required:!0,message:"基地负责人地址不能为空",trigger:"blur"}],baseArea:[{required:!0,message:"基地面积不能为空",trigger:"blur"}],baseAltitude:[{required:!0,message:"基地海拔不能为空",trigger:"blur"}],baseImg:[{required:!0,message:"现场图片不能为空",trigger:"blur"}],baseDes:[{required:!0,message:"基地描述不能为空",trigger:"blur"}],baseCoordinate:[{required:!0,message:"基地坐标不能为空",trigger:"blur"}]}}},created:function(){this.getInfo()},methods:{reset:function(){this.form={baseId:null,baseShortName:null,baseCode:null,baseName:null,baseLeader:null,leaderTel:null,baseAddress:null,baseArea:null,baseAltitude:null,baseImg:null,baseDes:null,baseCoordinate:""},this.resetForm("form")},getInfo:function(){var e=this;this.reset(),Object(l["b"])().then((function(t){var a=t.data;a&&(e.form=a)}))},cancel:function(){this.$store.dispatch("tagsView/delView",this.$route),this.$router.go(-1)},submitForm:function(){var e=this;this.$refs["form"].validate((function(t){t&&(null!=e.form.baseId?Object(l["c"])(e.form).then((function(t){e.$modal.msgSuccess("修改成功"),e.open=!1,e.getList()})):Object(l["a"])(e.form).then((function(t){e.$modal.msgSuccess("新增成功"),e.open=!1,e.getList()})))}))}}},n=i,c=(a("4ec0"),a("2877")),u=Object(c["a"])(n,r,s,!1,null,"21fa5b83",null);t["default"]=u.exports},"4ec0":function(e,t,a){"use strict";a("1eb9")},"5f0d":function(e,t,a){},7834:function(e,t,a){e.exports=a.p+"static/img/point.0f4b3ced.svg"},b9d0:function(e,t,a){"use strict";a.d(t,"d",(function(){return s})),a.d(t,"c",(function(){return l})),a.d(t,"a",(function(){return o})),a.d(t,"e",(function(){return i})),a.d(t,"b",(function(){return n}));var r=a("b775");function s(e){return Object(r["a"])({url:"/agriculture/land/cropLandList",method:"get",params:e})}function l(e){return Object(r["a"])({url:"/agriculture/land/"+e,method:"get"})}function o(e){return Object(r["a"])({url:"/agriculture/land",method:"post",data:e})}function i(e){return Object(r["a"])({url:"/agriculture/land",method:"put",data:e})}function n(e){return Object(r["a"])({url:"/agriculture/land/"+e,method:"delete"})}},d415:function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return l})),a.d(t,"c",(function(){return o}));var r=a("b775");function s(){return Object(r["a"])({url:"/agriculture/baseinfo",method:"get"})}function l(e){return Object(r["a"])({url:"/agriculture/baseinfo",method:"post",data:e})}function o(e){return Object(r["a"])({url:"/agriculture/baseinfo",method:"put",data:e})}},ff67:function(e,t,a){"use strict";a("5f0d")}}]);